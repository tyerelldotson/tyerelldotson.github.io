---
title: "Assignment 6 - Text Analytics"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message=FALSE, warning=FALSE)
suppressPackageStartupMessages({
  library(quanteda)
  library(quanteda.textstats)
  library(quanteda.textplots)
  library(readr)
  library(dplyr)
})
```

```{r run-scripts, echo=FALSE, message=FALSE, warning=FALSE}

source("quanteda_textanalytics01.R")
source("quanteda_textanalytics02.R")

```

### Understanding the Word Clouds

The word clouds show the most frequent and distinctive words used in U.S. presidential inaugural speeches. Each cloud represents either an individual president or a broader time period. The larger the word, the more often it appears or the more unique it is to that speaker’s language.

In this case, you can see patterns in tone and focus. For example, words like "freedom" and "us" stand out in Obama’s speeches, while "America" and "great" stand out in Trump’s. Word clouds are great illustrations of how language and priorities shift over time.

(These visuals are generated using the textplot_wordcloud() function from the quanteda.textplots package.)

```{r build-inaug, include=FALSE, message=FALSE, warning=FALSE}
library(quanteda); library(quanteda.textstats); library(dplyr)

# corpus → dfm
data(data_corpus_inaugural, package = "quanteda")
corp <- data_corpus_inaugural
dfm_inaug <- corp |>
  tokens(remove_punct = TRUE, remove_symbols = TRUE) |>
  tokens_remove(stopwords("en")) |>
  tokens_wordstem() |>
  dfm()

# --- Over time: pre-1900 vs post-2000 ---
era <- ifelse(docvars(dfm_inaug, "Year") < 1900, "pre1900",
              ifelse(docvars(dfm_inaug, "Year") >= 2000, "post2000", "other"))
dfm_era <- dfm_inaug[era != "other", ]
key_era <- textstat_keyness(dfm_era, target = (era[era != "other"] == "post2000"))

# robust top lists (don’t rely on head/tail)
ke_era <- key_era %>% mutate(side = ifelse(n_target > n_reference, "post2000", "pre1900"))
era_top_post2000 <- ke_era %>% filter(side == "post2000") %>% arrange(desc(chi2)) %>% head(12)
era_top_pre1900  <- ke_era %>% filter(side == "pre1900")  %>% arrange(desc(chi2)) %>% head(12)

# --- Party differences (Dem target) ---
has_party <- !is.na(docvars(dfm_inaug, "Party")) &
             docvars(dfm_inaug, "Party") %in% c("Democratic","Republican")
dfm_party <- dfm_inaug[has_party, ]
key_party <- textstat_keyness(dfm_party, target = (docvars(dfm_party, "Party") == "Democratic"))
kp <- key_party %>% mutate(side = ifelse(n_target > n_reference, "Democratic", "Republican"))
party_top_dem <- kp %>% filter(side == "Democratic") %>% arrange(desc(chi2)) %>% head(12)
party_top_rep <- kp %>% filter(side == "Republican") %>% arrange(desc(chi2)) %>% head(12)

# --- KWIC examples for color ---
kwic_examples <- kwic(tokens(corp), pattern = c("secur*","terror*","econom*","union","liberti*")) |>
  as.data.frame() |>
  select(docname, keyword, pre, post) |>
  head(6)

```

```{r keyness-inaug, echo=FALSE, message=FALSE, warning=FALSE}

## U.S. Presidential Inaugural Speeches

knitr::kable(head(era_top_post2000[, c("feature","chi2","p","n_target","n_reference")], 10),
             caption = "Top distinguishing terms in Post-2000 speeches")

knitr::kable(head(era_top_pre1900[, c("feature","chi2","p","n_target","n_reference")], 10),
             caption = "Top distinguishing terms in Pre-1900 speeches")

knitr::kable(head(party_top_dem[, c("feature","chi2","p","n_target","n_reference")], 10),
             caption = "Top distinguishing terms in Democratic speeches")

knitr::kable(head(party_top_rep[, c("feature","chi2","p","n_target","n_reference")], 10),
             caption = "Top distinguishing terms in Republican speeches")

knitr::kable(kwic_examples, caption = "KWIC examples from early inaugural speeches (Washington 1789)")

```

### Similarities and Differences Over Time and Among Presidents

**Over time:**\
Early inaugural speeches (pre-1900) were grounded in the nation’s founding ideals and moral principles. The KWIC lines from Washington’s 1789 address highlight words like liberties, union, and economy, tied to virtue and happiness. The overall tone centered on morality, stability, and natural order.

Post-2000 speeches, on the other hand, are filled with words like America, American, and today, pointing to a shift toward modern identity, global presence, and immediate political priorities. In short, presidential rhetoric moved from timeless ideals to a focus on action, identity, and leadership.

**Among presidents and parties:**\
Democratic speeches often include words such as democraci, fellow, and us, showing a consistent emphasis on unity, inclusion, and collective progress.

Republican speeches, meanwhile, highlight terms like everi, life, principl, nation, and confidm; language that leans more on individual resolve, moral conviction, and national strength.

Both parties talk about progress and change, but their tones differ: Democrats tend to focus on shared purpose and optimism, while Republicans emphasize perseverance and foundational principles.

**Overall:**\
Across time and political lines, every president appeals to unity and national purpose. What changes is the lens, from liberty and virtue in the early years to modern themes of leadership and resilience today. The tone also shifts by party: Democrats are more collective and aspirational, while Republicans are more principled and motivational.

[Note:]{.underline} Words in the analysis appear in stemmed form (e.g., *democraci* for “democracy/democratic,” *confid* for “confidence,” *everi* for “every”). Stemming helps group related word forms together but may slightly reduce readability.

### What is Wordfish?

From the Quanteda website, not much detail is given about what Wordfish actually is. To get a better grasp, I looked outside of Quanteda and found that Wordfish is a model that estimates where documents fall along a scale, like political leaning or tone, based on the words they use. It looks at how often certain words appear in each text and uses that to position them relative to one another. In short, it helps identify patterns or bias in language across different documents.
